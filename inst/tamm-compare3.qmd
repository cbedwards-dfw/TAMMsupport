---
title: "Comparing Limiting Stock complete mods"
date: today
execute: 
  warning: false
message: false
format: 
  html:
    fig-width: 10
code-fold: true
toc: true
embed-resources: true
editor: visual
params:
  tamm_path: "C:/Users/edwc1477/OneDrive - Washington State Executive Branch Agencies/Documents/WDFW FRAM team work/NOF material/NOF 2024/FRAM"
  tamm_name1: "Chin1024.xlsx"
  tamm_name2: "Chin1124.xlsx"
  tamm_name3: "Chin1224.xlsx"
---

*Report generated programmatically using the `TAMMsupport` package*

```{r}
library(tidyverse)
library("readxl")
library(here)
library(framrsquared)
library(kableExtra)
library(TAMMsupport)
tamm_path <- params$tamm_path
tamm_name1 <- params$tamm_name1
tamm_name2 <- params$tamm_name2
tamm_name3 <- params$tamm_name3
tamm.full1 <- paste0(tamm_path, "/", tamm_name1)
tamm.full2 <- paste0(tamm_path, "/", tamm_name2)
tamm.full3 <- paste0(tamm_path, "/", tamm_name3)
```


# Comparing `r paste0(tamm_name1, ", ", tamm_name2, ", and ", tamm_name3)`


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```


## Processing TAMM

```{r limiting stock tab, message=FALSE}
## ID all the stock names
dat1 <- TAMMsupport::clean_limiting_stock(tamm.full1)
dat2 <- TAMMsupport::clean_limiting_stock(tamm.full2)
dat3 <- TAMMsupport::clean_limiting_stock(tamm.full3)
```


# Summary tables

::: {.panel-tabset}

## `r tamm_name1`

```{r}
path.cur <- tamm.full1
dat_overview <- TAMMsupport::read_overview(path.cur)
overview.form <- TAMMsupport::format_overview(dat_overview)
TAMMsupport::kable_overview(
  dat_overview = overview.form$dat_overview,
  ind_indent = overview.form$ind_indent,
  col_bold = overview.form$col_bold
)
```


## `r tamm_name2`

```{r}
path.cur <- tamm.full2
dat_overview <- TAMMsupport::read_overview(path.cur)
overview.form <- TAMMsupport::format_overview(dat_overview)
TAMMsupport::kable_overview(
  dat_overview = overview.form$dat_overview,
  ind_indent = overview.form$ind_indent,
  col_bold = overview.form$col_bold
)
```



## `r tamm_name3`

```{r}
path.cur <- tamm.full3
dat_overview <- TAMMsupport::read_overview(path.cur)
overview.form <- TAMMsupport::format_overview(dat_overview)
TAMMsupport::kable_overview(
  dat_overview = overview.form$dat_overview,
  ind_indent = overview.form$ind_indent,
  col_bold = overview.form$col_bold
)
```

:::


# Compare exploitation

```{r}
render_child <- function(cur.stock) {
  res <- knitr::knit_child(
    text = xfun::read_utf8("tamm-compare3-child.qmd"),
    envir = rlang::env(cur.stock = cur.stock, dat1 = dat1, dat2 = dat2, dat3 = dat3),
    quiet = TRUE
  )
  cat(res, sep = "\n")
  cat("\n")
}
```


```{r}
#| results: 'asis'
#| echo: false
purrr::walk(unique(dat1$stock), render_child)
```
